



<!DOCTYPE html>
<html lang="en" class="">
  <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# object: http://ogp.me/ns/object# article: http://ogp.me/ns/article# profile: http://ogp.me/ns/profile#">
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Language" content="en">
    
    
    <title>kernel_review/a10c_54.md at master · hephaex/kernel_review</title>
    <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="GitHub">
    <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-114.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-144.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144.png">
    <meta property="fb:app_id" content="1401488693436528">

      <meta content="@github" name="twitter:site" /><meta content="summary" name="twitter:card" /><meta content="hephaex/kernel_review" name="twitter:title" /><meta content="kernel_review - The Linux Kernel review for ARMv7 3.13.0 (exynos 5420)" name="twitter:description" /><meta content="https://avatars0.githubusercontent.com/u/3781966?v=2&amp;s=400" name="twitter:image:src" />
<meta content="GitHub" property="og:site_name" /><meta content="object" property="og:type" /><meta content="https://avatars0.githubusercontent.com/u/3781966?v=2&amp;s=400" property="og:image" /><meta content="hephaex/kernel_review" property="og:title" /><meta content="https://github.com/hephaex/kernel_review" property="og:url" /><meta content="kernel_review - The Linux Kernel review for ARMv7 3.13.0 (exynos 5420)" property="og:description" />

      <meta name="browser-stats-url" content="/_stats">
    <link rel="assets" href="https://assets-cdn.github.com/">
    <link rel="conduit-xhr" href="https://ghconduit.com:25035">
    <link rel="xhr-socket" href="/_sockets">

    <meta name="msapplication-TileImage" content="/windows-tile.png">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="selected-link" value="repo_source" data-pjax-transient>
      <meta name="google-analytics" content="UA-3769691-2">

    <meta content="collector.githubapp.com" name="octolytics-host" /><meta content="collector-cdn.github.com" name="octolytics-script-host" /><meta content="github" name="octolytics-app-id" /><meta content="01EED2ED:0874:3F12A692:540C5396" name="octolytics-dimension-request_id" /><meta content="3781966" name="octolytics-actor-id" /><meta content="hephaex" name="octolytics-actor-login" /><meta content="c454bcbbfe257c99e2e455c510c2117b1456882b7a7e7edd3345f32e4e17f4a8" name="octolytics-actor-hash" />
    

    
    
    <link rel="icon" type="image/x-icon" href="https://assets-cdn.github.com/favicon.ico">


    <meta content="authenticity_token" name="csrf-param" />
<meta content="Kk/5e/sYG8aVl9gr09DnRygRxHuwTX55/5+XLdcN9HfipJmc8vpvWIQWe64chJZLxWJqocCDadEweknwrv+JLQ==" name="csrf-token" />

    <link href="https://assets-cdn.github.com/assets/github-0ee9064842419bc947ae49576d87065a9fa954d5.css" media="all" rel="stylesheet" type="text/css" />
    <link href="https://assets-cdn.github.com/assets/github2-fdf72e5a92bee3dcbf0220f2d727814f13d53277.css" media="all" rel="stylesheet" type="text/css" />
    


    <meta http-equiv="x-pjax-version" content="431a5115b41ea69b6a1d3d5cb9557eba">

      
  <meta name="description" content="kernel_review - The Linux Kernel review for ARMv7 3.13.0 (exynos 5420)">
  <meta name="go-import" content="github.com/hephaex/kernel_review git https://github.com/hephaex/kernel_review.git">

  <meta content="3781966" name="octolytics-dimension-user_id" /><meta content="hephaex" name="octolytics-dimension-user_login" /><meta content="21377888" name="octolytics-dimension-repository_id" /><meta content="hephaex/kernel_review" name="octolytics-dimension-repository_nwo" /><meta content="true" name="octolytics-dimension-repository_public" /><meta content="false" name="octolytics-dimension-repository_is_fork" /><meta content="21377888" name="octolytics-dimension-repository_network_root_id" /><meta content="hephaex/kernel_review" name="octolytics-dimension-repository_network_root_nwo" />
  <link href="https://github.com/hephaex/kernel_review/commits/master.atom" rel="alternate" title="Recent Commits to kernel_review:master" type="application/atom+xml">

  </head>


  <body class="logged_in  env-production  vis-public page-blob">
    <a href="#start-of-content" tabindex="1" class="accessibility-aid js-skip-to-content">Skip to content</a>
    <div class="wrapper">
      
      
      
      


      <div class="header header-logged-in true">
  <div class="container clearfix">

    <a class="header-logo-invertocat" href="https://github.com/" aria-label="Homepage" ga-data-click="Header, go to dashboard, icon:logo">
  <span class="mega-octicon octicon-mark-github"></span>
</a>


      <div class="site-search repo-scope js-site-search">
          <form accept-charset="UTF-8" action="/hephaex/kernel_review/search" class="js-site-search-form" data-global-search-url="/search" data-repo-search-url="/hephaex/kernel_review/search" method="get"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /></div>
  <input type="text"
    class="js-site-search-field is-clearable"
    data-hotkey="s"
    name="q"
    placeholder="Search"
    data-global-scope-placeholder="Search GitHub"
    data-repo-scope-placeholder="Search"
    tabindex="1"
    autocapitalize="off">
  <div class="scope-badge">This repository</div>
</form>
      </div>
      <ul class="header-nav left">
        <li class="header-nav-item explore">
          <a class="header-nav-link" href="/explore" data-ga-click="Header, go to explore, text:explore">Explore</a>
        </li>
          <li class="header-nav-item">
            <a class="header-nav-link" href="https://gist.github.com" data-ga-click="Header, go to gist, text:gist">Gist</a>
          </li>
          <li class="header-nav-item">
            <a class="header-nav-link" href="/blog" data-ga-click="Header, go to blog, text:blog">Blog</a>
          </li>
        <li class="header-nav-item">
          <a class="header-nav-link" href="https://help.github.com" data-ga-click="Header, go to help, text:help">Help</a>
        </li>
      </ul>

    
<ul class="header-nav user-nav right" id="user-links">
  <li class="header-nav-item dropdown js-menu-container">
    <a class="header-nav-link name" href="/hephaex" data-ga-click="Header, go to profile, text:username">
      <img alt="MSCho" class="avatar" data-user="3781966" height="20" src="https://avatars0.githubusercontent.com/u/3781966?v=2&amp;s=40" width="20" />
      <span class="css-truncate">
        <span class="css-truncate-target">hephaex</span>
      </span>
    </a>
  </li>

  <li class="header-nav-item dropdown js-menu-container">
    <a class="header-nav-link js-menu-target tooltipped tooltipped-s" href="#" aria-label="Create new..." data-ga-click="Header, create new, icon:add">
      <span class="octicon octicon-plus"></span>
      <span class="dropdown-caret"></span>
    </a>

    <div class="dropdown-menu-content js-menu-content">
      
<ul class="dropdown-menu">
  <li>
    <a href="/new"><span class="octicon octicon-repo"></span> New repository</a>
  </li>
  <li>
    <a href="/organizations/new"><span class="octicon octicon-organization"></span> New organization</a>
  </li>


    <li class="dropdown-divider"></li>
    <li class="dropdown-header">
      <span title="hephaex/kernel_review">This repository</span>
    </li>
      <li>
        <a href="/hephaex/kernel_review/issues/new"><span class="octicon octicon-issue-opened"></span> New issue</a>
      </li>
      <li>
        <a href="/hephaex/kernel_review/settings/collaboration"><span class="octicon octicon-person"></span> New collaborator</a>
      </li>
</ul>

    </div>
  </li>

  <li class="header-nav-item">
        <a href="/notifications" aria-label="You have no unread notifications" class="header-nav-link notification-indicator tooltipped tooltipped-s" data-ga-click="Header, go to notifications, icon:read" data-hotkey="g n">
        <span class="mail-status all-read"></span>
        <span class="octicon octicon-inbox"></span>
</a>
  </li>

  <li class="header-nav-item">
    <a class="header-nav-link tooltipped tooltipped-s" href="/settings/profile" id="account_settings" aria-label="Settings" data-ga-click="Header, go to settings, icon:settings">
      <span class="octicon octicon-gear"></span>
    </a>
  </li>

  <li class="header-nav-item">
    <form accept-charset="UTF-8" action="/logout" class="logout-form" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="uxRScAEnT4ElPYnR9x9RdXNURGGN/1Mu1EfefRS6jr5CFsww7c8q7OqaZ1EsROKzLbO7vEYW0MqLA5GPo0+c6w==" /></div>
      <button class="header-nav-link sign-out-button tooltipped tooltipped-s" aria-label="Sign out" data-ga-click="Header, sign out, icon:logout">
        <span class="octicon octicon-sign-out"></span>
      </button>
</form>  </li>

</ul>


    
  </div>
</div>

      

        


      <div id="start-of-content" class="accessibility-aid"></div>
          <div class="site" itemscope itemtype="http://schema.org/WebPage">
    <div id="js-flash-container">
      
    </div>
    <div class="pagehead repohead instapaper_ignore readability-menu">
      <div class="container">
        
<ul class="pagehead-actions">

    <li class="subscription">
      <form accept-charset="UTF-8" action="/notifications/subscribe" class="js-social-container" data-autosubmit="true" data-remote="true" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="q5Xt8EY+MqU7GtW0PalnlD6mNVt7SoXByQKuCw/LtPUdrfqT81D0WXvSgIUbpv9sBbj7cmArBlq4RDXFmSMM+A==" /></div>  <input id="repository_id" name="repository_id" type="hidden" value="21377888" />

    <div class="select-menu js-menu-container js-select-menu">
      <a class="social-count js-social-count" href="/hephaex/kernel_review/watchers">
        1
      </a>
      <a href="/hephaex/kernel_review/subscription"
        class="minibutton select-menu-button with-count js-menu-target" role="button" tabindex="0" aria-haspopup="true">
        <span class="js-select-button">
          <span class="octicon octicon-eye"></span>
          Unwatch
        </span>
      </a>

      <div class="select-menu-modal-holder">
        <div class="select-menu-modal subscription-menu-modal js-menu-content" aria-hidden="true">
          <div class="select-menu-header">
            <span class="select-menu-title">Notifications</span>
            <span class="octicon octicon-x js-menu-close" role="button" aria-label="Close"></span>
          </div> <!-- /.select-menu-header -->

          <div class="select-menu-list js-navigation-container" role="menu">

            <div class="select-menu-item js-navigation-item " role="menuitem" tabindex="0">
              <span class="select-menu-item-icon octicon octicon-check"></span>
              <div class="select-menu-item-text">
                <input id="do_included" name="do" type="radio" value="included" />
                <h4>Not watching</h4>
                <span class="description">Be notified when participating or @mentioned.</span>
                <span class="js-select-button-text hidden-select-button-text">
                  <span class="octicon octicon-eye"></span>
                  Watch
                </span>
              </div>
            </div> <!-- /.select-menu-item -->

            <div class="select-menu-item js-navigation-item selected" role="menuitem" tabindex="0">
              <span class="select-menu-item-icon octicon octicon octicon-check"></span>
              <div class="select-menu-item-text">
                <input checked="checked" id="do_subscribed" name="do" type="radio" value="subscribed" />
                <h4>Watching</h4>
                <span class="description">Be notified of all conversations.</span>
                <span class="js-select-button-text hidden-select-button-text">
                  <span class="octicon octicon-eye"></span>
                  Unwatch
                </span>
              </div>
            </div> <!-- /.select-menu-item -->

            <div class="select-menu-item js-navigation-item " role="menuitem" tabindex="0">
              <span class="select-menu-item-icon octicon octicon-check"></span>
              <div class="select-menu-item-text">
                <input id="do_ignore" name="do" type="radio" value="ignore" />
                <h4>Ignoring</h4>
                <span class="description">Never be notified.</span>
                <span class="js-select-button-text hidden-select-button-text">
                  <span class="octicon octicon-mute"></span>
                  Stop ignoring
                </span>
              </div>
            </div> <!-- /.select-menu-item -->

          </div> <!-- /.select-menu-list -->

        </div> <!-- /.select-menu-modal -->
      </div> <!-- /.select-menu-modal-holder -->
    </div> <!-- /.select-menu -->

</form>
    </li>

  <li>
    
  <div class="js-toggler-container js-social-container starring-container ">

    <form accept-charset="UTF-8" action="/hephaex/kernel_review/unstar" class="js-toggler-form starred js-unstar-button" data-remote="true" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="mWLmzVMWt5Az4NnULhBd+Yt21mMVZf/xTPIcTvwoEnekU6bWYb2/n8LFuPbcU8HO9BakZuNj0mm8MedNxyA8rw==" /></div>
      <button
        class="minibutton with-count js-toggler-target star-button"
        aria-label="Unstar this repository" title="Unstar hephaex/kernel_review">
        <span class="octicon octicon-star"></span>
        Unstar
      </button>
        <a class="social-count js-social-count" href="/hephaex/kernel_review/stargazers">
          0
        </a>
</form>
    <form accept-charset="UTF-8" action="/hephaex/kernel_review/star" class="js-toggler-form unstarred js-star-button" data-remote="true" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="hCnTLxVnNCM2iP+yL6xCDyArjSzLQpii0FoznTjpgGh/pwztBw5PZSRFfoq09L2uTeE6mPT4aFa0Fdcu6gsN5A==" /></div>
      <button
        class="minibutton with-count js-toggler-target star-button"
        aria-label="Star this repository" title="Star hephaex/kernel_review">
        <span class="octicon octicon-star"></span>
        Star
      </button>
        <a class="social-count js-social-count" href="/hephaex/kernel_review/stargazers">
          0
        </a>
</form>  </div>

  </li>


        <li>
          <a href="/hephaex/kernel_review/fork" class="minibutton with-count js-toggler-target fork-button tooltipped-n" title="Fork your own copy of hephaex/kernel_review to your account" aria-label="Fork your own copy of hephaex/kernel_review to your account" rel="nofollow" data-method="post">
            <span class="octicon octicon-repo-forked"></span>
            Fork
          </a>
          <a href="/hephaex/kernel_review/network" class="social-count">0</a>
        </li>

</ul>

        <h1 itemscope itemtype="http://data-vocabulary.org/Breadcrumb" class="entry-title public">
          <span class="mega-octicon octicon-repo"></span>
          <span class="author"><a href="/hephaex" class="url fn" itemprop="url" rel="author"><span itemprop="title">hephaex</span></a></span><!--
       --><span class="path-divider">/</span><!--
       --><strong><a href="/hephaex/kernel_review" class="js-current-repository js-repo-home-link">kernel_review</a></strong>

          <span class="page-context-loader">
            <img alt="" height="16" src="https://assets-cdn.github.com/images/spinners/octocat-spinner-32.gif" width="16" />
          </span>

        </h1>
      </div><!-- /.container -->
    </div><!-- /.repohead -->

    <div class="container">
      <div class="repository-with-sidebar repo-container new-discussion-timeline  ">
        <div class="repository-sidebar clearfix">
            
<div class="sunken-menu vertical-right repo-nav js-repo-nav js-repository-container-pjax js-octicon-loaders" data-issue-count-url="/hephaex/kernel_review/issues/counts">
  <div class="sunken-menu-contents">
    <ul class="sunken-menu-group">
      <li class="tooltipped tooltipped-w" aria-label="Code">
        <a href="/hephaex/kernel_review" aria-label="Code" class="selected js-selected-navigation-item sunken-menu-item" data-hotkey="g c" data-pjax="true" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches /hephaex/kernel_review">
          <span class="octicon octicon-code"></span> <span class="full-word">Code</span>
          <img alt="" class="mini-loader" height="16" src="https://assets-cdn.github.com/images/spinners/octocat-spinner-32.gif" width="16" />
</a>      </li>

        <li class="tooltipped tooltipped-w" aria-label="Issues">
          <a href="/hephaex/kernel_review/issues" aria-label="Issues" class="js-selected-navigation-item sunken-menu-item js-disable-pjax" data-hotkey="g i" data-selected-links="repo_issues repo_labels repo_milestones /hephaex/kernel_review/issues">
            <span class="octicon octicon-issue-opened"></span> <span class="full-word">Issues</span>
            <span class="js-issue-replace-counter"></span>
            <img alt="" class="mini-loader" height="16" src="https://assets-cdn.github.com/images/spinners/octocat-spinner-32.gif" width="16" />
</a>        </li>

      <li class="tooltipped tooltipped-w" aria-label="Pull Requests">
        <a href="/hephaex/kernel_review/pulls" aria-label="Pull Requests" class="js-selected-navigation-item sunken-menu-item js-disable-pjax" data-hotkey="g p" data-selected-links="repo_pulls /hephaex/kernel_review/pulls">
            <span class="octicon octicon-git-pull-request"></span> <span class="full-word">Pull Requests</span>
            <span class="js-pull-replace-counter"></span>
            <img alt="" class="mini-loader" height="16" src="https://assets-cdn.github.com/images/spinners/octocat-spinner-32.gif" width="16" />
</a>      </li>


        <li class="tooltipped tooltipped-w" aria-label="Wiki">
          <a href="/hephaex/kernel_review/wiki" aria-label="Wiki" class="js-selected-navigation-item sunken-menu-item js-disable-pjax" data-hotkey="g w" data-selected-links="repo_wiki /hephaex/kernel_review/wiki">
            <span class="octicon octicon-book"></span> <span class="full-word">Wiki</span>
            <img alt="" class="mini-loader" height="16" src="https://assets-cdn.github.com/images/spinners/octocat-spinner-32.gif" width="16" />
</a>        </li>
    </ul>
    <div class="sunken-menu-separator"></div>
    <ul class="sunken-menu-group">

      <li class="tooltipped tooltipped-w" aria-label="Pulse">
        <a href="/hephaex/kernel_review/pulse/weekly" aria-label="Pulse" class="js-selected-navigation-item sunken-menu-item" data-pjax="true" data-selected-links="pulse /hephaex/kernel_review/pulse/weekly">
          <span class="octicon octicon-pulse"></span> <span class="full-word">Pulse</span>
          <img alt="" class="mini-loader" height="16" src="https://assets-cdn.github.com/images/spinners/octocat-spinner-32.gif" width="16" />
</a>      </li>

      <li class="tooltipped tooltipped-w" aria-label="Graphs">
        <a href="/hephaex/kernel_review/graphs" aria-label="Graphs" class="js-selected-navigation-item sunken-menu-item" data-pjax="true" data-selected-links="repo_graphs repo_contributors /hephaex/kernel_review/graphs">
          <span class="octicon octicon-graph"></span> <span class="full-word">Graphs</span>
          <img alt="" class="mini-loader" height="16" src="https://assets-cdn.github.com/images/spinners/octocat-spinner-32.gif" width="16" />
</a>      </li>
    </ul>


      <div class="sunken-menu-separator"></div>
      <ul class="sunken-menu-group">
        <li class="tooltipped tooltipped-w" aria-label="Settings">
          <a href="/hephaex/kernel_review/settings" aria-label="Settings" class="js-selected-navigation-item sunken-menu-item" data-pjax="true" data-selected-links="repo_settings /hephaex/kernel_review/settings">
            <span class="octicon octicon-tools"></span> <span class="full-word">Settings</span>
            <img alt="" class="mini-loader" height="16" src="https://assets-cdn.github.com/images/spinners/octocat-spinner-32.gif" width="16" />
</a>        </li>
      </ul>
  </div>
</div>

              <div class="only-with-full-nav">
                
  
<div class="clone-url "
  data-protocol-type="http"
  data-url="/users/set_protocol?protocol_selector=http&amp;protocol_type=push">
  <h3><span class="text-emphasized">HTTPS</span> clone URL</h3>
  <div class="input-group">
    <input type="text" class="input-mini input-monospace js-url-field"
           value="https://github.com/hephaex/kernel_review.git" readonly="readonly">
    <span class="input-group-button">
      <button aria-label="Copy to clipboard" class="js-zeroclipboard minibutton zeroclipboard-button" data-clipboard-text="https://github.com/hephaex/kernel_review.git" data-copied-hint="Copied!" type="button"><span class="octicon octicon-clippy"></span></button>
    </span>
  </div>
</div>

  
<div class="clone-url open"
  data-protocol-type="ssh"
  data-url="/users/set_protocol?protocol_selector=ssh&amp;protocol_type=push">
  <h3><span class="text-emphasized">SSH</span> clone URL</h3>
  <div class="input-group">
    <input type="text" class="input-mini input-monospace js-url-field"
           value="git@github.com:hephaex/kernel_review.git" readonly="readonly">
    <span class="input-group-button">
      <button aria-label="Copy to clipboard" class="js-zeroclipboard minibutton zeroclipboard-button" data-clipboard-text="git@github.com:hephaex/kernel_review.git" data-copied-hint="Copied!" type="button"><span class="octicon octicon-clippy"></span></button>
    </span>
  </div>
</div>

  
<div class="clone-url "
  data-protocol-type="subversion"
  data-url="/users/set_protocol?protocol_selector=subversion&amp;protocol_type=push">
  <h3><span class="text-emphasized">Subversion</span> checkout URL</h3>
  <div class="input-group">
    <input type="text" class="input-mini input-monospace js-url-field"
           value="https://github.com/hephaex/kernel_review" readonly="readonly">
    <span class="input-group-button">
      <button aria-label="Copy to clipboard" class="js-zeroclipboard minibutton zeroclipboard-button" data-clipboard-text="https://github.com/hephaex/kernel_review" data-copied-hint="Copied!" type="button"><span class="octicon octicon-clippy"></span></button>
    </span>
  </div>
</div>


<p class="clone-options">You can clone with
      <a href="#" class="js-clone-selector" data-protocol="http">HTTPS</a>,
      <a href="#" class="js-clone-selector" data-protocol="ssh">SSH</a>,
      or <a href="#" class="js-clone-selector" data-protocol="subversion">Subversion</a>.
  <a href="https://help.github.com/articles/which-remote-url-should-i-use" class="help tooltipped tooltipped-n" aria-label="Get help on which URL is right for you.">
    <span class="octicon octicon-question"></span>
  </a>
</p>



                <a href="/hephaex/kernel_review/archive/master.zip"
                   class="minibutton sidebar-button"
                   aria-label="Download the contents of hephaex/kernel_review as a zip file"
                   title="Download the contents of hephaex/kernel_review as a zip file"
                   rel="nofollow">
                  <span class="octicon octicon-cloud-download"></span>
                  Download ZIP
                </a>
              </div>
        </div><!-- /.repository-sidebar -->

        <div id="js-repo-pjax-container" class="repository-content context-loader-container" data-pjax-container>
          

<a href="/hephaex/kernel_review/blob/8ff94724d1c5c9cd5c8b086847b28f3e3d6c0799/a10c_54.md" class="hidden js-permalink-shortcut" data-hotkey="y">Permalink</a>

<!-- blob contrib key: blob_contributors:v21:61b643404f52352d0b8b935f4e4551a5 -->

<div class="file-navigation">
  
<div class="select-menu js-menu-container js-select-menu left">
  <span class="minibutton select-menu-button js-menu-target css-truncate" data-hotkey="w"
    data-master-branch="master"
    data-ref="master"
    title="master"
    role="button" aria-label="Switch branches or tags" tabindex="0" aria-haspopup="true">
    <span class="octicon octicon-git-branch"></span>
    <i>branch:</i>
    <span class="js-select-button css-truncate-target">master</span>
  </span>

  <div class="select-menu-modal-holder js-menu-content js-navigation-container" data-pjax aria-hidden="true">

    <div class="select-menu-modal">
      <div class="select-menu-header">
        <span class="select-menu-title">Switch branches/tags</span>
        <span class="octicon octicon-x js-menu-close" role="button" aria-label="Close"></span>
      </div> <!-- /.select-menu-header -->

      <div class="select-menu-filters">
        <div class="select-menu-text-filter">
          <input type="text" aria-label="Find or create a branch…" id="context-commitish-filter-field" class="js-filterable-field js-navigation-enable" placeholder="Find or create a branch…">
        </div>
        <div class="select-menu-tabs">
          <ul>
            <li class="select-menu-tab">
              <a href="#" data-tab-filter="branches" class="js-select-menu-tab">Branches</a>
            </li>
            <li class="select-menu-tab">
              <a href="#" data-tab-filter="tags" class="js-select-menu-tab">Tags</a>
            </li>
          </ul>
        </div><!-- /.select-menu-tabs -->
      </div><!-- /.select-menu-filters -->

      <div class="select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket" data-tab-filter="branches">

        <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring">


            <div class="select-menu-item js-navigation-item selected">
              <span class="select-menu-item-icon octicon octicon-check"></span>
              <a href="/hephaex/kernel_review/blob/master/a10c_54.md"
                 data-name="master"
                 data-skip-pjax="true"
                 rel="nofollow"
                 class="js-navigation-open select-menu-item-text css-truncate-target"
                 title="master">master</a>
            </div> <!-- /.select-menu-item -->
        </div>

          <form accept-charset="UTF-8" action="/hephaex/kernel_review/branches" class="js-create-branch select-menu-item select-menu-new-item-form js-navigation-item js-new-item-form" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="9MYIjPKEMcnb6APYERr8lRIQN65xH7MlVRBxwltuDYTqxmwBrsVZPJRr9Pwx8D7oqfefob3tT0WQiB/HUlXaGQ==" /></div>
            <span class="octicon octicon-git-branch select-menu-item-icon"></span>
            <div class="select-menu-item-text">
              <h4>Create branch: <span class="js-new-item-name"></span></h4>
              <span class="description">from ‘master’</span>
            </div>
            <input type="hidden" name="name" id="name" class="js-new-item-value">
            <input type="hidden" name="branch" id="branch" value="master">
            <input type="hidden" name="path" id="path" value="a10c_54.md">
          </form> <!-- /.select-menu-item -->

      </div> <!-- /.select-menu-list -->

      <div class="select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket" data-tab-filter="tags">
        <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring">


        </div>

        <div class="select-menu-no-results">Nothing to show</div>
      </div> <!-- /.select-menu-list -->

    </div> <!-- /.select-menu-modal -->
  </div> <!-- /.select-menu-modal-holder -->
</div> <!-- /.select-menu -->

  <div class="button-group right">
    <a href="/hephaex/kernel_review/find/master"
          class="js-show-file-finder minibutton empty-icon tooltipped tooltipped-s"
          data-pjax
          data-hotkey="t"
          aria-label="Quickly jump between files">
      <span class="octicon octicon-list-unordered"></span>
    </a>
    <button class="js-zeroclipboard minibutton zeroclipboard-button"
          data-clipboard-text="a10c_54.md"
          aria-label="Copy to clipboard"
          data-copied-hint="Copied!">
      <span class="octicon octicon-clippy"></span>
    </button>
  </div>

  <div class="breadcrumb">
    <span class='repo-root js-repo-root'><span itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb"><a href="/hephaex/kernel_review" class="" data-branch="master" data-direction="back" data-pjax="true" itemscope="url"><span itemprop="title">kernel_review</span></a></span></span><span class="separator"> / </span><strong class="final-path">a10c_54.md</strong>
  </div>
</div>


  <div class="commit commit-loader file-history-tease js-deferred-content" data-url="/hephaex/kernel_review/contributors/master/a10c_54.md">
    <div class="file-history-tease-header">
      Fetching contributors&hellip;
    </div>

    <div class="participation">
      <p class="loader-loading"><img alt="" height="16" src="https://assets-cdn.github.com/images/spinners/octocat-spinner-32-EAF2F5.gif" width="16" /></p>
      <p class="loader-error">Cannot retrieve contributors at this time</p>
    </div>
  </div>

<div class="file-box">
  <div class="file">
    <div class="meta clearfix">
      <div class="info file-name">
          <span>600 lines (530 sloc)</span>
          <span class="meta-divider"></span>
        <span>20.673 kb</span>
      </div>
      <div class="actions">
        <div class="button-group">
          <a href="/hephaex/kernel_review/raw/master/a10c_54.md" class="minibutton " id="raw-url">Raw</a>
            <a href="/hephaex/kernel_review/blame/master/a10c_54.md" class="minibutton js-update-url-with-hash">Blame</a>
          <a href="/hephaex/kernel_review/commits/master/a10c_54.md" class="minibutton " rel="nofollow">History</a>
        </div><!-- /.button-group -->


              <a class="octicon-button js-update-url-with-hash"
                 href="/hephaex/kernel_review/edit/master/a10c_54.md"
                 data-method="post" rel="nofollow" data-hotkey="e"><span class="octicon octicon-pencil"></span></a>

            <a class="octicon-button danger"
               href="/hephaex/kernel_review/delete/master/a10c_54.md"
               data-method="post" data-test-id="delete-blob-file" rel="nofollow">
          <span class="octicon octicon-trashcan"></span>
        </a>
      </div><!-- /.actions -->
    </div>
        <div id="readme" class="blob instapaper_body">
    <article class="markdown-body entry-content" itemprop="mainContentOfPage"><h1>
<a name="user-content-%EC%9D%BC%EC%8B%9C--20140517-54%EC%A3%BC%EC%B0%A8" class="anchor" href="#%EC%9D%BC%EC%8B%9C--20140517-54%EC%A3%BC%EC%B0%A8" aria-hidden="true"><span class="octicon octicon-link"></span></a>일시 : 2014.05.17 (54주차)</h1>

<h1>
<a name="user-content-%EB%AA%A8%EC%9E%84%EB%AA%85--naver%EA%B0%9C%EB%B0%9C%EC%9E%90%EC%BB%A4%EB%AE%A4%EB%8B%88%ED%8B%B0%EC%A7%80%EC%9B%90_iamrootorg_10%EC%B0%A8arm-c" class="anchor" href="#%EB%AA%A8%EC%9E%84%EB%AA%85--naver%EA%B0%9C%EB%B0%9C%EC%9E%90%EC%BB%A4%EB%AE%A4%EB%8B%88%ED%8B%B0%EC%A7%80%EC%9B%90_iamrootorg_10%EC%B0%A8arm-c" aria-hidden="true"><span class="octicon octicon-link"></span></a>모임명 : NAVER개발자커뮤니티지원_IAMROOT.ORG_10차ARM-C</h1>

<h1>
<a name="user-content-%EC%9E%A5%EC%86%8C--%ED%86%A0%EC%A6%88-%ED%83%80%EC%9B%8C%EC%A0%90" class="anchor" href="#%EC%9E%A5%EC%86%8C--%ED%86%A0%EC%A6%88-%ED%83%80%EC%9B%8C%EC%A0%90" aria-hidden="true"><span class="octicon octicon-link"></span></a>장소 : 토즈 타워점</h1>

<h1>
<a name="user-content-%EC%9E%A5%EC%86%8C%EC%A7%80%EC%9B%90--naver-%EA%B0%9C%EB%B0%9C%EC%9E%90-%EC%BB%A4%EB%AE%A4%EB%8B%88%ED%8B%B0-%EC%A7%80%EC%9B%90-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%A8" class="anchor" href="#%EC%9E%A5%EC%86%8C%EC%A7%80%EC%9B%90--naver-%EA%B0%9C%EB%B0%9C%EC%9E%90-%EC%BB%A4%EB%AE%A4%EB%8B%88%ED%8B%B0-%EC%A7%80%EC%9B%90-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%A8" aria-hidden="true"><span class="octicon octicon-link"></span></a>장소지원 : NAVER 개발자 커뮤니티 지원 프로그램</h1>

<h1>
<a name="user-content-%EC%B0%B8%EC%97%AC%EC%9D%B8%EC%9B%90---4%EB%AA%85" class="anchor" href="#%EC%B0%B8%EC%97%AC%EC%9D%B8%EC%9B%90---4%EB%AA%85" aria-hidden="true"><span class="octicon octicon-link"></span></a>참여인원 :  4명</h1>

<h1>
<a name="user-content-%EC%8A%A4%ED%84%B0%EB%94%94-%EC%A7%84%EB%8F%84-" class="anchor" href="#%EC%8A%A4%ED%84%B0%EB%94%94-%EC%A7%84%EB%8F%84-" aria-hidden="true"><span class="octicon octicon-link"></span></a>스터디 진도 :</h1>

<ul class="task-list">
<li>지난 스터디에 이어서 mem_init()을 계속 분석합니다.</li>
<li>start_kernel()-&gt; mm_init()-&gt;kmem_cache_init()-&gt;create_boot_cache() 분석중</li>
<li>kmem_cache_init()이 분석 중이어서 이번 후기는 내용이 짧습니다. 

<ul class="task-list">
<li>내용이 복잡해서 slub()이 끝나는 시점에서 내용 정리를 함께 다시 하기로 했습니다. </li>
<li>자세한 후기도 그때 다시 정리하려고 합니다.</li>
</ul>
</li>
</ul><h1>
<a name="user-content-%EC%8A%A4%ED%84%B0%EB%94%94-%EC%A3%BC%EC%9A%94-%EB%82%B4%EC%9A%A9" class="anchor" href="#%EC%8A%A4%ED%84%B0%EB%94%94-%EC%A3%BC%EC%9A%94-%EB%82%B4%EC%9A%A9" aria-hidden="true"><span class="octicon octicon-link"></span></a>스터디 주요 내용</h1>

<ul class="task-list">
<li>buddy할당자에 이어서 kmem 할당자 (Slub)을 분석중입니다. </li>
<li>mem_init()-&gt;kmem_cache_init()-&gt;create_boot_cache()-&gt;__kmem_cache_create()
-&gt;kmem_cache_open()-&gt;init_kmem_cache_nodes-&gt;early_kmem_cache_node_alloc()
-&gt;new_slab()-&gt;allocate_slab()-&gt;alloc_slab_page()-&gt;alloc_pages_exact_node()
-&gt;__alloc_pages()-&gt;__alloc_pages_nodemask();</li>
<li>커널 버전을 3.13.11로 바꿨습니다. 괴도키드님께서 머지를 해주셨습니다.</li>
</ul><h2>
<a name="user-content-vm_stat" class="anchor" href="#vm_stat" aria-hidden="true"><span class="octicon octicon-link"></span></a>vm_stat[?]</h2>

<ul class="task-list">
<li>vm_stat[0] : number of free pags 수 </li>
<li>vm_stat[1] : batch : chunk size for buddy add/remove</li>
</ul><ul class="task-list">
<li>mem_init()-&gt;kmem_cache_init()-&gt;create_boot_cache()
&gt;   err = __kmem_cache_create(s, flags);</li>
<li>__kmem_cache_create()
&gt;// s: &amp;boot_kmem_cache_node, flags: SLAB_HWCACHE_ALIGN: 0x00002000UL
&gt;   err = kmem_cache_open(s, flags);</li>
<li>kmem_cache_open()
&gt;   // s: &amp;boot_kmem_cache_node
&gt;   if (!init_kmem_cache_nodes(s))</li>
<li>init_kmem_cache_nodes
&gt;       // slab_state: DOWN: 1
&gt;       if (slab_state == DOWN) {
&gt;           // node: 0
&gt;           early_kmem_cache_node_alloc(node);
&gt;           continue;
&gt;       }</li>
<li>early_kmem_cache_node_alloc()
&gt;   // kmem_cache_node: &amp;boot_kmem_cache_node, GFP_NOWAIT: 0, node: 0
&gt;   page = new_slab(kmem_cache_node, GFP_NOWAIT, node);</li>
<li>new_slab()
&gt;   // s: &amp;boot_kmem_cache_node, flags: GFP_NOWAIT: 0, node: 0
&gt;   // GFP_RECLAIM_MASK: 0x13ef0, GFP_CONSTRAINT_MASK: 0x60000
&gt;   page = allocate_slab(s,
&gt;       flags &amp; (GFP_RECLAIM_MASK | GFP_CONSTRAINT_MASK), node);</li>
<li>allocate_slab()
&gt;   // alloc_gfp: 0x1200, node: 0, oo: boot_kmem_cache_node.oo
&gt;   page = alloc_slab_page(alloc_gfp, node, oo);</li>
<li>alloc_slab_page()
&gt;   // node: 0, NUMA_NO_NODE: -1
&gt;   if (node == NUMA_NO_NODE)
&gt;       return alloc_pages(flags, order);
&gt;   else
&gt;       // node: 0, flags: 0x201200, order: 0
&gt;       return alloc_pages_exact_node(node, flags, order);</li>
<li>alloc_pages_exact_node()
&gt;   // gfp_mask: 0x201200, order: 0, nid: 0,
&gt;   // node_zonelist(0, 0x201200): contig_page_data-&gt;node_zonelists
&gt;   return __alloc_pages(gfp_mask, order, node_zonelist(nid, gfp_mask));</li>
<li>__alloc_pages()
&gt;   // gfp_mask: 0x201200, order: 0
&gt;   // zonelist: contig_page_data-&gt;node_zonelists, NULL
&gt;   return __alloc_pages_nodemask(gfp_mask, order, zonelist, NULL);</li>
<li>__alloc_pages_nodemask();
&gt;   // gfp_mask: 0x201200, __GFP_HARDWALL: 0x20000, nodemask: NULL, order: 0
&gt;   // zonelist: contig_page_data-&gt;node_zonelists, high_zoneidx: ZONE_NORMAL: 0
&gt;   // alloc_flags: 0x41, preferred_zone: (&amp;contig_page_data)-&gt;node_zones[0]
&gt;   // migratetype: MIGRATE_UNMOVABLE: 0
&gt;   page = get_page_from_freelist(gfp_mask|__GFP_HARDWALL, nodemask, order,
&gt;           zonelist, high_zoneidx, alloc_flags,
&gt;           preferred_zone, migratetype);</li>
<li>get_page_from_freelist()
&gt;       // zone: contig_page_data-&gt;node_zones[0], order: 0, mark: 0
&gt;       // classzone_idx: 0 alloc_flags: 0x41
&gt;       // zone_watermark_ok(contig_page_data-&gt;node_zones[0], 0, 0, 0, 0x41): 1
&gt;       if (!zone_watermark_ok(zone, order, mark,
&gt;                      classzone_idx, alloc_flags)) {</li>
<li>zone_watermark_ok()
&gt;   // z: contig_page_data-&gt;node_zones[0], order: 0, mark: 0
&gt;   // classzone_idx: 0 alloc_flags: 0x41
&gt;   // zone_page_state(contig_page_data-&gt;node_zones[0], NR_FREE_PAGES): ????
&gt;   return __zone_watermark_ok(z, order, mark, classzone_idx, alloc_flags,
&gt;                   zone_page_state(z, NR_FREE_PAGES));
&gt;   // return 1</li>
<li>get_page_from_freelist()
&gt;       // preferred_zone: (&amp;contig_page_data)-&gt;node_zones[0]
&gt;       // zone: contig_page_data-&gt;node_zones[0], order: 0, gfp_mask: 0x221200
&gt;       // migratetype: MIGRATE_UNMOVABLE: 0
&gt;       page = buffered_rmqueue(preferred_zone, zone, order,
&gt;                       gfp_mask, migratetype);</li>
<li>buffered_rmqueue()
&gt;       if (list_empty(list)) {
&gt;           pcp-&gt;count += rmqueue_bulk(zone, 0,
&gt;                   pcp-&gt;batch, list,
&gt;                   migratetype, cold);
&gt;           if (unlikely(list_empty(list)))
&gt;               goto failed;
&gt;       }</li>
<li>rmqueue_bulk()
&gt;   for (i = 0; i &lt; count; ++i) {
&gt;       struct page *page = __rmqueue(zone, order, migratetype);
&gt;       if (unlikely(page == NULL))
&gt;           break;</li>
<li>__rmqueue()
&gt; retry_reserve:
&gt;   page = __rmqueue_smallest(zone, order, migratetype);</li>
<li>__rmqueue_smallest()
&gt;   // order : 0, MAX_ORDER : 11
&gt;   for (current_order = order; current_order &lt; MAX_ORDER; ++current_order) {
&gt;       // zone-&gt;free_area[0] : contig_page_data_node_zones[0].free_area[0]&gt;
&gt;       area = &amp;(zone-&gt;free_area[current_order]);
&gt;       // area: &amp;(contig_page_data_node_zones[0].free_area[0])
&gt;
&gt;       // migratetype : 0,
&gt;       // area-&gt;free_list[0] : &amp;&amp;(contig_page_data_node_zones[0].free_area[0])-&gt;free_list[0] :1
&gt;       if (list_empty(&amp;area-&gt;free_list[migratetype]))
&gt;           continue;</li>
</ul><blockquote>
<ul class="task-list">
<li>if (list_empty(&amp;area-&gt;free_list[migratetype]))
&gt;  - 여기서 free_list[0]이 의미하는 바를 알아보자.
&gt;  - free_list가 현재 오더에서 빈것이 있는지 찾는다.
&gt;  - 빈것이 없으면 continue로 오더가 증가한다.
&gt;  - 빈것이 있으면 다음주로 실행된다.
&gt;  - 그런데 migratetype : 0은 UNMOVEABLE이므로,
&gt;  - if가 NULL이되어
&gt;  - free_list[]는 __free_one_page에서 넣었다.
&gt;  - </li>
<li>  if (unlikely(!page) &amp;&amp; migratetype != MIGRATE_RESERVE) {
page : NULL, migragetype : 0, MIGRATE_RESERVE : 3
// if문 실행
page = __rmqueue_fallback(zone, order, migratetype);</li>
<li>__rmqueue_fallback()</li>
</ul>
<pre><code>    // MAX_ORDER : 11, order : 0
    for (current_order = MAX_ORDER-1; current_order &gt;= order;
                        --current_order) {
        for (i = 0;; i++) {
        // i:0, start_migratetype:0, fallback[0][0]: MIGRATE_RECLAIMABLE: 1
        // i:1, start_migratetype:0, fallback[0][1]: MIGRATE_MOVABLE : 2
            migratetype = fallbacks[start_migratetype][i];
            // fallbacks[0][0] : MIGRATE_RECLAIMABLE : 1
            // migratetype : MIGRATE_RECLAIMABLE : 1
            // fallbacks[0][1] : MIGRATE_MOVABLE : 2
            // migratetype : MIGRATE_MOVABLE : 2
</code></pre>
</blockquote>

<pre><code>        /* MIGRATE_RESERVE handled later if necessary */
        if (migratetype == MIGRATE_RESERVE)
            break;

        // current_order : 10
        area = &amp;(zone-&gt;free_area[current_order]);
        // area : &amp;(zone-&gt;free_area[10]:
        //      : contig_page_data-&gt;node_zones[0].free_area[10]

        // i:0, migratetype : MIGRATE_RECLIMABLE : 1
        // i:0, area-&gt;free_list[1] : contig_page_data-&gt;node_zones[0].free_area[10]-&gt;free_list[1]
        // i:1, migratetype : MIGRATE_MOVABLE : 2
        // i:1, area-&gt;free_list[2] : contig_page_data-&gt;node_zones[0].free_area[10]-&gt;free_list[2]
        if (list_empty(&amp;area-&gt;free_list[migratetype]))
            continue;

        //  current_order:5, migratetype : MIGRATE_MOVABLE: 2 아래 코드 수행할것으로 보고 분석
        // i:1, curren_order:5
        // i:1 ,are-&gt;free_list[2]: contig_page_data-&gt;node_zones[0].free_area[5]-&gt;free_list[2].next
        page = list_entry(area-&gt;free_list[migratetype].next,
                struct page, lru);
        // i:1 area-&gt;nr_free : (&amp;contig_page_data-&gt;node_zones[0].free_area[5]-&gt;nr_free 1감소
        area-&gt;nr_free--;

        // i:1 zone : contig_page_data-&gt;node_zone[0]
        // i
        new_type = try_to_steal_freepages(zone, page,
                          start_migratetype,
                          migratetype);

        /* Remove the page from the freelists */
        list_del(&amp;page-&gt;lru);
        rmv_page_order(page);

        expand(zone, page, order, current_order, area,
               new_type);

        trace_mm_page_alloc_extfrag(page, order, current_order,
            start_migratetype, migratetype, new_type);

        return page;
    }
}
</code></pre>

<pre><code>
&gt;           new_type = try_to_steal_freepages(zone, page,
&gt;                             start_migratetype,
&gt;                             migratetype);
- try_to_steal_freepages()
</code></pre>

<p>static int try_to_steal_freepages(struct zone *zone, struct page *page,
                  int start_type, int fallback_type)
{
    int current_order = page_order(page);</p>

<pre><code>/*
 * When borrowing from MIGRATE_CMA, we need to release the excess
 * buddy pages to CMA itself.
 */
if (is_migrate_cma(fallback_type))
    return fallback_type;

/* Take ownership for orders &gt;= pageblock_order */
// current_order : 5 &gt;= pageblock_order : 10
if (current_order &gt;= pageblock_order) {
    change_pageblock_range(page, current_order, start_type);
    return start_type;
}

// current_order : 5
// page_group_by_mobility_disabled : 0
if (current_order &gt;= pageblock_order / 2 ||
    start_type == MIGRATE_RECLAIMABLE ||
    page_group_by_mobility_disabled) {
    int pages;

    pages = move_freepages_block(zone, page, start_type);

    /* Claim the whole block if over half of it is free */
    if (pages &gt;= (1 &lt;&lt; (pageblock_order-1)) ||
            page_group_by_mobility_disabled) {

        set_pageblock_migratetype(page, start_type);
        return start_type;
    }

}

return fallback_type;
</code></pre>

<p>}</p>

<pre><code>
&gt;       pages = move_freepages_block(zone, page, start_type);
- move_freepages_block()
&gt; zone : contig_page_data-&gt;node_zones[0],
&gt; 
</code></pre>

<p>int move_freepages_block(struct zone *zone, struct page *page,
                int migratetype)
{
    unsigned long start_pfn, end_pfn;
    struct page *start_page, *end_page;</p>

<pre><code>// 가정 : order 5의 migratetype MIGRARE_MOVALE 인 lru page
//        의 pfn값을 0x200000 으로 가정하고 분석

start_pfn = page_to_pfn(page);
// start_pfn : 0x20000

// pageblock_nr_pages : 0x400 (1024)
start_pfn = start_pfn &amp; ~(pageblock_nr_pages-1);
// start_pfn = 0x20000 

start_page = pfn_to_page(start_pfn);
// start_page : page 0x20000 (pfn)

end_page = start_page + pageblock_nr_pages - 1;
// end_page : page 0x20CFF (pfn)
end_pfn = start_pfn + pageblock_nr_pages - 1;
// end_pfn : 0x20000 + ( 0x400 -1)
// end_pfn : 0x20CFF

/* Do not cross zone boundaries */
// zone : contig_page_data-&gt;node_zones[0], start_pfn: 0x20000
// zone_spans_pfn : 1
if (!zone_spans_pfn(zone, start_pfn))
    start_page = page;

// zone : contig_page_data-&gt;node_zones[0], end_pfn: 0x20cff
// zone_spans_pfn : 1
if (!zone_spans_pfn(zone, end_pfn))
    return 0;

return move_freepages(zone, start_page, end_page, migratetype);
</code></pre>

<p>}</p>

<pre><code>&gt;   return move_freepages(zone, start_page, end_page, migratetype);
- move_freepages()
</code></pre>

<p>/*</p>

<ul class="task-list">
<li>Move the free pages in a range to the free lists of the requested type.</li>
<li>Note that start_page and end_pages are not aligned on a pageblock</li>
<li>boundary. If alignment is required, use move_freepages_block()
*/
int move_freepages(struct zone *zone,
          struct page *start_page, struct page *end_page,
          int migratetype)
{
struct page *page;
unsigned long order;
int pages_moved = 0;</li>
</ul><h1>
<a name="user-content-ifndef-config_holes_in_zone" class="anchor" href="#ifndef-config_holes_in_zone" aria-hidden="true"><span class="octicon octicon-link"></span></a>ifndef CONFIG_HOLES_IN_ZONE</h1>

<pre><code>/*
 * page_zone is not safe to call in this context when
 * CONFIG_HOLES_IN_ZONE is set. This bug check is probably redundant
 * anyway as we check zone boundaries in move_freepages_block().
 * Remove at a later date when no bug reports exist related to
 * grouping pages by mobility
 */
 BUG_ON(page_zone(start_page) != page_zone(end_page));
 // 시작과 끝이 같은 존에 있는지 확인하여 아니면 버그.
</code></pre>

<h1>
<a name="user-content-endif" class="anchor" href="#endif" aria-hidden="true"><span class="octicon octicon-link"></span></a>endif</h1>

<pre><code>// start: page : 0x20000 (pfn), end_page : page 0x20CFF (pfn)
for (page = start_page; page &lt;= end_page;) {
    /* Make sure we are not inadvertently changing nodes */

    // page_to_nid(page)
    VM_BUG_ON(page_to_nid(page) != zone_to_nid(zone));
    // 같은 존에 있는지 확인.

    if (!pfn_valid_within(page_to_pfn(page))) {
        page++;
        continue;
    }

    if (!PageBuddy(page)) {
        page++;
        continue;
    }

    order = page_order(page);
    // order : 5

    // zone-&gt;free_area[5[.free_list[0]: cotig_page_data-&gt;node_zones[0].free_area[5].free_area[0]
    list_move(&amp;page-&gt;lru,
          &amp;zone-&gt;free_area[order].free_list[migratetype]);

    // 에 page : 0x20000 (pfn)
    // page-&gt;lru를 자기 자신으로 초기화하고, free_list에 불인다.
    // migratetype 을 2에 있는 page를 0으로 바꾸고, 
    // zone-&gt;free_area[5[.free_list[0]: cotig_page_data-&gt;node_zones[0].free_area[5].free_area[2]
    // contig_page_data-&gt;node_zones[0].free_list[2] 에서
    // contig_page_data-&gt;node_zone[0.free_area[5].free_list[0]로 옮김
    set_freepage_migratetype(page, migratetype);
    // migrage type 이 2에서 0으로 바뀜.

    page += 1 &lt;&lt; order;
    pages_moved += 1 &lt;&lt; order;
}

return pages_moved;
// pages_moved : 1024 (옴겨진 page 수)
</code></pre>

<p>}</p>

<pre><code>&gt;       VM_BUG_ON(page_to_nid(page) != zone_to_nid(zone));
- page_to_nid()
</code></pre>

<p>static inline int page_to_nid(const struct page *page)
{
    return (page-&gt;flags &gt;&gt; NODES_PGSHIFT) &amp; NODES_MASK;
    // NODES_PGSHIFT : 0,
    // NODES_MASK : 0,
    // return (page-&gt;flags &gt;&gt; 0) &amp; 3; 하위 2비트만 리턴.
}</p>

<pre><code>- zone_to_nid()
&gt; return 0;


&gt;if (!pfn_valid_within(page_to_pfn(page))) {
&gt;           page++;
&gt;           continue;
- pfn_valid_within()
&gt; return 1;

&gt;       if (!PageBuddy(page)) {
&gt;           page++;
&gt;           continue;
&gt;       }
- PageBuddy
&gt; return 1;

- try_to_steal_freepages()
&gt;       if (pages &gt;= (1 &lt;&lt; (pageblock_order-1)) ||
&gt;               page_group_by_mobility_disabled) {
&gt;
&gt;           // pages: ???
&gt;           // &gt;
&gt;           set_pageblock_migratetype(page, start_type);
&gt;           return start_type;
- set_pageblock_migratetype()
&gt;&gt; page 블록의 migratetype을 바꿔줌 (2-&gt;0)

- try_to_steal_freepages()
&gt; return start_type : 0

- __rmqueue_fallback()
&gt; new_type = try_to_steal_freepages() : 0
&gt;
&gt;o list_del(&amp;page-&gt;lru);
&gt; rmv_page_order(page);

- rmv_page_order()
&gt; page-&gt;_mapcount : -1
&gt; page-&gt;private : 0
&gt; // page의 _mapcount 를 -1, private값을 0으로 초기화

- __rmqueue_fallback()
&gt; expand(zone, page, order, current_order, area,
&gt;                  new_type);
&gt; // i: 1, order ; 0, current_order : 5, start_migratetype:
&gt; // new_type : 0
&gt; return page;
&gt; // page : migratetype이 MIGRATE_UNMOVEABLE인 page

- expand()
</code></pre>

<p>static inline void expand(struct zone *zone, struct page *page,
    int low, int high, struct free_area *area,
    int migratetype)
{
    // high : current_order : 5
    unsigned long size = 1 &lt;&lt; high;</p>

<pre><code>// high : 5, low : 0
while (high &gt; low) {
    // area: &amp;contig_page_data-&gt;node_zones[0].free_area[5]
    area--;
    // area: &amp;contig_page_data-&gt;node_zones[0].free_area[4]

    // high : 5
    high--;
    // high : 4

    // size : 32
    size &gt;&gt;= 1;
    // size : 16

    // zone : contig_page_data-&gt;node_zones[0]
    // page : order 5의 migratetype MIGRATE_MOVEABLE인 lru page
    VM_BUG_ON(bad_range(zone, &amp;page[size]));
</code></pre>

<h1>
<a name="user-content-ifdef-config_debug_pagealloc---not-set" class="anchor" href="#ifdef-config_debug_pagealloc---not-set" aria-hidden="true"><span class="octicon octicon-link"></span></a>ifdef CONFIG_DEBUG_PAGEALLOC  // not set</h1>

<pre><code>    if (high &lt; debug_guardpage_minorder()) {
        /*
         * Mark as guard pages (or page), that will allow to
         * merge back to allocator when buddy will be freed.
         * Corresponding page table entries will not be touched,
         * pages will stay not present in virtual address space
         */
        INIT_LIST_HEAD(&amp;page[size].lru);
        set_page_guard_flag(&amp;page[size]);
        set_page_private(&amp;page[size], high);
        /* Guard pages are not available for any usage */
        __mod_zone_freepage_state(zone, -(1 &lt;&lt; high),
                      migratetype);
        continue;
    }
</code></pre>

<h1>
<a name="user-content-endif-1" class="anchor" href="#endif-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>endif</h1>

<pre><code>    // size : 16
    // page : order 5의 migratetype MIGRATE_MOVEABLE인 lru page + 16).lru
    // migratetype : 0 ,
    // area-&gt;free_list[0] : &amp;contig_page_data-&gt;node_zones[0].free_area[4])-&gt;free_list[0]
    list_add(&amp;page[size].lru, &amp;area-&gt;free_list[migratetype]);
    // &amp;contig_page_data-&gt;node_zones[0].free_area[4])-&gt;free_list[0]에
    // order K의 migratetype MIGRATE_MOVEABLE lru page + 16 인 page 추가

    // (&amp;contig_page_data-&gt;node_zones[0].free_area[4]-&gt;free_list[0]
    area-&gt;nr_free++;
    // free page 수 증가

    // size : 16,
    // page[16] : order 5의 migratetype 이 MIGRATE_MOVEABLE인 lru page
    set_page_order(&amp;page[size], high);
    // page의 _mapcount 값을 -128, private를 4로 변경.

}
</code></pre>

<p>}</p>

<pre><code>## expand ():
- 페이지가 0이 필요한데. MIGRATE_UNMOVABLE이 없어서.
- MIGRATE_MOVEABLE을 order 5부터 4, 3, 2, 1으로 해서
- order 1의 slub을 MIGRAT_UNMOVEABLE로 설정하고
- 나머지 5부터 반쪽씩 free로 설정한다.
- smallest에서 MIGRATE_UNMOVEABLE이 있었으면 프리페이지 확장을 하지만,
- 우리는 smallest가 없었기 때문에 unlikely를 들어와서 fallback에서
- 가장 큰 영역부터 (오더 5)에서 부터 순차적으로 내려오면서.
- 남은 영역을 free로 확장해서 설정하고,
- 오더 1에서 MIGRATE_MOVEABLE에서 할당 받아 MiGRATE_UNMOVEABLE로 설정하고
- 역시 남은 영역을 free로 확장해서 할당한다. 

- (&amp;contig_page_data-&gt;node_zones[0].free_area[4])-&gt;free_list[0] 에
- order 5의 migratetype MIGRATE_MOVEABLE인 lru page + 16 인 page추가
- free page 수 증가
- page의 _mapcount 값을 -128, private를 4로 변경.

- expand(zone, page, order, current_order, area, new_type)
  - order는 필요한 크기
  - current_order : 버디에서 가져온 크기
  - 큰 버디 오더에서 사용하려는 오더를 제외한 나머지 버디영역을
  - 미사용영역으로 정리함.
  - (필요한 크기보다 가져온 크기가 클때 )실행함.

## __rmqueue()
- 해당 zone에서 order(크기)에 맞고 migratetype이 같은 page를 구해옴
- migratetype이 일치 하지 않으면.
- fallbacks의 enum의 메모리정책에 따라서 할당 받는다. 
- 1. __rmque_samllest () UNMOVERABLE
- 2. __rmqure_fallback () MOVEABLE
- 3. RESERVE에서 찾는다. 
&gt;
&gt;       if (!page) {
&gt;           migratetype = MIGRATE_RESERVE;
&gt;           goto retry_reserve;

&gt;   trace_mm_page_alloc_zone_locked(page, order, migratetype);
&gt;   // page : migratetype MIGRATE_
- fallback에서 메모리 정책이 결정된다.

## requeue_bulk()
&gt;       struct page *page = __rmqueue(zone, order, migratetype);
위의 분석이었다.

&gt;       // cold :0&gt;
&gt;       if (likely(cold == 0))
&gt;           list_add(&amp;page-&gt;lru, list);
            // page-&gt;lru : (migtratetype이 MIGRATE_UNMOVEABLE인 page)-&gt;lru
            // list : (&amp;boot_pageset + (__per_cpu_offset[0]))-&gt;pcp.lists[0]

&gt;       else
&gt;           list_add_tail(&amp;page-&gt;lru, list);
&gt;        // page의 lru가 cold가 1일때 tail로 cold가 0일때 head로 등록됨

&gt;       // IS_ENABLED(CONFIG_CMA)  // n/A
&gt;       if (IS_ENABLED(CONFIG_CMA)) {
&gt;           mt = get_pageblock_migratetype(page);
&gt;           if (!is_migrate_cma(mt) &amp;&amp; !is_migrate_isolate(mt))
&gt;               mt = migratetype;
&gt;       }
&gt;
&gt;       // page-&gt;index = migratetype
&gt;       set_freepage_migratetype(page, mt);
&gt;       // page의 index필드를 migratetype 0으로 변경
&gt;
&gt;       // list : (&amp;boot_pageset + (__per_cpu_offset[0]))-&gt;pcp.lists[0]
&gt;       // page-&gt;lru : (migratetype 이 MIGRATE_UNMOVEABLE인 page)-&gt;lru
&gt;       list = &amp;page-&gt;lru;
&gt;       // lru는 색인이고, 자료는 pcp.list[0]에 값이 업데이트 됨
&gt;
&gt;       // mt : 0
&gt;       if (is_migrate_cma(mt)) // false
&gt;           __mod_zone_page_state(zone, NR_FREE_CMA_PAGES,
&gt;                         -(1 &lt;&lt; order));
&gt;      }
&gt;      // zone: contig_page_data-&gt;node_zones[0], NR_FREE_PAGES : 0, i:1
&gt;      __mod_zone_page_state(zone, NR_FREE_PAGES, -(i &lt;&lt; order));
&gt;&gt;     // vm_stat[enum]에서 NR_FREE_PAGES인 2번째 인자를 가지고 update하는 함수
&gt;&gt;      // x = delta + __this_cpu_read(*p)
&gt;&gt;     // (&amp;contig_pgate_data)-&gt;node_zones[ZONE_NORMAL].vm_stat[0]의 값을 update함
&gt;&gt;     // t : 32???6 -1 5
&gt;      return i;
&gt;      // order : 0, return i : 1

## buffered_rmqueue()
&gt;       if (list_empty(list)) {
&gt;           pcp-&gt;count += rmqueue_bulk(zone, 0,
&gt;                   pcp-&gt;batch, list,
&gt;                   migratetype, cold);
            // pcp-&gt;count : (&amp;boot_pageset + (__per_cpu_offset[0]))-&gt;pcp.list[0]
&gt;           if (unlikely(list_empty(list))) // fault
&gt;               goto failed;
&gt;       }
- // cold : 0
&gt;       if (cold)
&gt;           page = list_entry(list-&gt;prev, struct page, lru);
&gt;       else
&gt;           // list-next :((&amp;boot_pageset + (__per_cpu_offset[0]))-&gt;pcp.list[0])-&gt;next
&gt;           page = list_entry(list-&gt;next, struct page, lru);
&gt;           // page : migratetype이 MIGRATE_UNMOVEABEL인 page
&gt;       list_del(&amp;page-&gt;lru);
&gt;       // list-next :((&amp;boot_pageset + (__per_cpu_offset[0]))-&gt;pcp.list[0]에서 현제 page-&gt;lru삭제
&gt;       pcp-&gt;count--;
&gt;       //  list-next :((&amp;boot_pageset + (__per_cpu_offset[0]))-&gt;pcp.list[0]).count : 0

&gt;       // gfp_flags : 0x221200
&gt;       if (!gfp_thisnode_allocation(gfp_flags)) // true : !false 
&gt;           // zone: contig_page_data-&gt;noce_zones[0], NR_ALLOC_BATCH :1, order: 0
&gt;           __mod_zone_page_state(zone, NR_ALLOC_BATCH, -(1 &lt;&lt; order));
&gt;           // (&amp;contig_page_data-&gt;node_zones[0]-&gt;vm_stat[1] update
&gt;           // 
&gt;

## code_highliter
# ARM architecture
1. architecture 개론 , CIFS, RISC, 역사
2. CPU
3. memory MMU
4. cache.
5. asm
</code></pre></article>
  </div>

  </div>
</div>

<a href="#jump-to-line" rel="facebox[.linejump]" data-hotkey="l" style="display:none">Jump to Line</a>
<div id="jump-to-line" style="display:none">
  <form accept-charset="UTF-8" class="js-jump-to-line-form">
    <input class="linejump-input js-jump-to-line-field" type="text" placeholder="Jump to line&hellip;" autofocus>
    <button type="submit" class="button">Go</button>
  </form>
</div>

        </div>

      </div><!-- /.repo-container -->
      <div class="modal-backdrop"></div>
    </div><!-- /.container -->
  </div><!-- /.site -->


    </div><!-- /.wrapper -->

      <div class="container">
  <div class="site-footer">
    <ul class="site-footer-links right">
      <li><a href="https://status.github.com/">Status</a></li>
      <li><a href="http://developer.github.com">API</a></li>
      <li><a href="http://training.github.com">Training</a></li>
      <li><a href="http://shop.github.com">Shop</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/about">About</a></li>

    </ul>

    <a href="/" aria-label="Homepage">
      <span class="mega-octicon octicon-mark-github" title="GitHub"></span>
    </a>

    <ul class="site-footer-links">
      <li>&copy; 2014 <span title="0.06946s from github-fe139-cp1-prd.iad.github.net">GitHub</span>, Inc.</li>
        <li><a href="/site/terms">Terms</a></li>
        <li><a href="/site/privacy">Privacy</a></li>
        <li><a href="/security">Security</a></li>
        <li><a href="/contact">Contact</a></li>
    </ul>
  </div><!-- /.site-footer -->
</div><!-- /.container -->


    <div class="fullscreen-overlay js-fullscreen-overlay" id="fullscreen_overlay">
  <div class="fullscreen-container js-suggester-container">
    <div class="textarea-wrap">
      <textarea name="fullscreen-contents" id="fullscreen-contents" class="fullscreen-contents js-fullscreen-contents js-suggester-field" placeholder=""></textarea>
    </div>
  </div>
  <div class="fullscreen-sidebar">
    <a href="#" class="exit-fullscreen js-exit-fullscreen tooltipped tooltipped-w" aria-label="Exit Zen Mode">
      <span class="mega-octicon octicon-screen-normal"></span>
    </a>
    <a href="#" class="theme-switcher js-theme-switcher tooltipped tooltipped-w"
      aria-label="Switch themes">
      <span class="octicon octicon-color-mode"></span>
    </a>
  </div>
</div>



    <div id="ajax-error-message" class="flash flash-error">
      <span class="octicon octicon-alert"></span>
      <a href="#" class="octicon octicon-x close js-ajax-error-dismiss" aria-label="Dismiss error"></a>
      Something went wrong with that request. Please try again.
    </div>


      <script crossorigin="anonymous" src="https://assets-cdn.github.com/assets/frameworks-0c1b00f7935ae85624f5fc5d40d52d60febf92b4.js" type="text/javascript"></script>
      <script async="async" crossorigin="anonymous" src="https://assets-cdn.github.com/assets/github-fbf037c05b1b216496f330cff338007e2f09a2a1.js" type="text/javascript"></script>
      
      
        <script async src="https://www.google-analytics.com/analytics.js"></script>
  </body>
</html>

